<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì•„ì´í° ë°°ê²½í™”ë©´ ë¹„ìœ¨ ë§ì¶¤ ë„êµ¬</title>
    <style>
        :root {
            --bg-color: #1e1e1e;
            --text-color: #f0f0f0;
            --accent-color: #007aff;
            --input-bg: #2c2c2c;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        h1 { margin-bottom: 20px; font-size: 1.5rem; }
        
        .controls {
            background: var(--input-bg);
            padding: 20px;
            border-radius: 12px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            margin-bottom: 20px;
        }

        .control-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; font-size: 0.9rem; }
        
        input[type="file"], input[type="number"], input[type="color"], select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #444;
            background: #3a3a3a;
            color: white;
            box-sizing: border-box;
        }

        button {
            width: 100%;
            padding: 12px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover { background-color: #005bb5; }

        canvas {
            max-width: 100%;
            height: auto;
            border: 2px solid #444;
            border-radius: 12px;
            margin-top: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        .download-link {
            display: block;
            margin-top: 15px;
            text-align: center;
            color: var(--accent-color);
            text-decoration: none;
            font-weight: bold;
        }
    </style>
</head>
<body>

    <h1>ğŸ“± ë°°ê²½í™”ë©´ ì—¬ë°± ìƒì„±ê¸°</h1>

    <div class="controls">
        <div class="control-group">
            <label>1. ì´ë¯¸ì§€ ì„ íƒ</label>
            <input type="file" id="imageInput" accept="image/*">
        </div>

        <div class="control-group">
            <label>2. ëª©í‘œ í•´ìƒë„ (ì•„ì´í° ëª¨ë¸)</label>
            <select id="resolutionSelect">
                <option value="1290x2796">iPhone 16/15/14 Pro Max (1290x2796)</option>
                <option value="1179x2556">iPhone 16/15/14 Pro (1179x2556)</option>
                <option value="1170x2532">iPhone 14/13/12 (1170x2532)</option>
                <option value="1284x2778">iPhone 13/12 Pro Max (1284x2778)</option>
                <option value="1125x2436">iPhone X/XS/11 Pro (1125x2436)</option>
                <option value="custom">ì‚¬ìš©ì ì§€ì • (ì§ì ‘ ì…ë ¥)</option>
            </select>
        </div>

        <div class="control-group" id="customRes" style="display:none; flex-direction: row; gap: 10px;">
            <input type="number" id="customW" placeholder="ê°€ë¡œ" value="1290">
            <input type="number" id="customH" placeholder="ì„¸ë¡œ" value="2796">
        </div>

        <div class="control-group">
            <label>3. ì—¬ë°± ìŠ¤íƒ€ì¼</label>
            <select id="bgStyle">
                <option value="color">ë‹¨ìƒ‰ (ì§€ì • ìƒ‰ìƒ)</option>
                <option value="blur">ë¸”ëŸ¬ ì²˜ë¦¬ (ì´ë¯¸ì§€ í™•ì¥)</option>
            </select>
        </div>

        <div class="control-group" id="colorPickerGroup">
            <label>ì—¬ë°± ìƒ‰ìƒ</label>
            <input type="color" id="bgColor" value="#000000">
        </div>

        <button onclick="processImage()">ë°°ê²½í™”ë©´ ìƒì„±í•˜ê¸°</button>
        <a id="downloadLink" class="download-link" style="display: none;">ë‹¤ìš´ë¡œë“œ</a>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        const imageInput = document.getElementById('imageInput');
        const resolutionSelect = document.getElementById('resolutionSelect');
        const customRes = document.getElementById('customRes');
        const bgStyle = document.getElementById('bgStyle');
        const colorPickerGroup = document.getElementById('colorPickerGroup');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const downloadLink = document.getElementById('downloadLink');

        let originalImage = new Image();
        let isImageLoaded = false;

        // UI ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        resolutionSelect.addEventListener('change', (e) => {
            customRes.style.display = e.target.value === 'custom' ? 'flex' : 'none';
        });

        bgStyle.addEventListener('change', (e) => {
            colorPickerGroup.style.display = e.target.value === 'color' ? 'block' : 'none';
        });

        imageInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (event) => {
                originalImage = new Image();
                originalImage.onload = () => {
                    isImageLoaded = true;
                    processImage(); // ì´ë¯¸ì§€ ë¡œë“œ ì‹œ ìë™ ì²˜ë¦¬
                };
                originalImage.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        function getTargetSize() {
            if (resolutionSelect.value === 'custom') {
                return {
                    w: parseInt(document.getElementById('customW').value) || 1290,
                    h: parseInt(document.getElementById('customH').value) || 2796
                };
            }
            const [w, h] = resolutionSelect.value.split('x').map(Number);
            return { w, h };
        }

        function processImage() {
            if (!isImageLoaded) {
                alert("ë¨¼ì € ì´ë¯¸ì§€ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return;
            }

            const target = getTargetSize();
            canvas.width = target.w;
            canvas.height = target.h;

            // ë°°ê²½ ê·¸ë¦¬ê¸°
            if (bgStyle.value === 'color') {
                ctx.fillStyle = document.getElementById('bgColor').value;
                ctx.fillRect(0, 0, target.w, target.h);
            } else {
                // ë¸”ëŸ¬ íš¨ê³¼ êµ¬í˜„ (í™•ëŒ€ í›„ ë¸”ëŸ¬)
                ctx.save();
                // ì´ë¯¸ì§€ë¥¼ ìº”ë²„ìŠ¤ ê½‰ ì°¨ê²Œ ê·¸ë¦¼ (Cover ëª¨ë“œ)
                const scale = Math.max(target.w / originalImage.width, target.h / originalImage.height);
                const x = (target.w / 2) - (originalImage.width / 2) * scale;
                const y = (target.h / 2) - (originalImage.height / 2) * scale;
                
                ctx.filter = 'blur(40px)'; // ë¸”ëŸ¬ ê°•ë„
                // ë¸”ëŸ¬ ì²˜ë¦¬ ì‹œ ê°€ì¥ìë¦¬ê°€ í¬ë¯¸í•´ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì•½ê°„ ë” í¬ê²Œ ê·¸ë¦¼
                ctx.drawImage(originalImage, x - 20, y - 20, originalImage.width * scale + 40, originalImage.height * scale + 40);
                ctx.restore();
                
                // ì–´ë‘¡ê²Œ ì²˜ë¦¬ (ì„ íƒ ì‚¬í•­: ê°€ë…ì„±ì„ ìœ„í•´)
                ctx.fillStyle = "rgba(0, 0, 0, 0.3)";
                ctx.fillRect(0, 0, target.w, target.h);
            }

            // ì›ë³¸ ì´ë¯¸ì§€ ê·¸ë¦¬ê¸° (Aspect Fit / Contain ëª¨ë“œ)
            const scale = Math.min(target.w / originalImage.width, target.h / originalImage.height);
            const drawW = originalImage.width * scale;
            const drawH = originalImage.height * scale;
            const drawX = (target.w - drawW) / 2;
            const drawY = (target.h - drawH) / 2;

            ctx.drawImage(originalImage, drawX, drawY, drawW, drawH);

            // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
            const dataURL = canvas.toDataURL('image/png');
            downloadLink.href = dataURL;
            downloadLink.download = 'iphone_wallpaper.png';
            downloadLink.style.display = 'block';
            downloadLink.innerText = "ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (í´ë¦­)";
        }
    </script>
</body>
</html>